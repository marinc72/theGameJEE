<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
    <h:head>
        <title>TODO supply a title</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <script src="js/counter.js" type="text/javascript"/>

    </h:head>
    <style>
#myDIV {
    width: 100%;
    padding: 50px 0;
    text-align: center;
    background-color: lightblue;
    margin-top: 20px;
}
</style>
    <body>
        <c:set var="temps" value="#{controlerMissions.getMissionId(idUsr)}"/>
        <span id="varTest" style="display:none">#{controlerMissions.getTime(temps)}</span>
        <script>
                var countDownDate = document.getElementById("varTest").innerHTML;
                // Update the count down every 1 second
                var x = setInterval(function() {
                  // Get todays date and time
                  var now = new Date().getTime();

                  // Find the distance between now an the count down date
                  var distance = countDownDate - now;

                  // Time calculations for days, hours, minutes and seconds
                  var days = Math.floor(distance / (1000 * 60 * 60 * 24));
                  var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                  var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                  var seconds = Math.floor((distance % (1000 * 60)) / 1000);

                  document.getElementById("demo").innerHTML = days + "d " + hours + "h " + minutes + "m " + seconds + "s ";
                    // If the count down is finished, write some text 
                    if ((distance * Number.POSITIVE_INFINITY) === Number.NEGATIVE_INFINITY) {
                      clearInterval(x);
                      document.getElementById("varTest").innerHTML = "EXPIRED";
                      myFunction();
                    }
                }, 1000);
        </script>
        <p id="demo"></p>
        <button onclick="myFunction()">Try it</button>
<div id="myDIV" style="display:none">
    <h:form>
    <c:set var="idUser" value="#{controlerUser.actId}"/>
    <c:set var="idPerso" value="#{controlerPersonnage.getPersoID(idUser)}"/>
    <c:set var="missExp" value="#{controlerMissions.getMissionExperience(idUser)}"/>
    #{controlerPersonnage.updatePerso(idPerso, missExp)}
    #{controlerMissions.deleteMission(idUser)}
    <p:commandButton value="Go back" ajax="false"/>
    </h:form>
</div>


<script>
function myFunction() {
    var x = document.getElementById("myDIV");
    x.style.display = "block";
}
</script>
    </body>
</html>
